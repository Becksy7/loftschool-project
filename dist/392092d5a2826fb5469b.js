(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{122:function(e,t,r){},139:function(e,t,r){"use strict";var i=r(122);r.n(i).a},149:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("base-template",[r("div",{staticClass:"main__caption"},[r("h1",{staticClass:"main__title"},[e._v("Блок «Отзывы»")])]),e._v(" "),r("div",{staticClass:"reviews-wrap"},[e.editReviewIsShown?r("edit-review",{on:{cancel:function(t){e.editReviewIsShown=!1}},model:{value:e.currentReview,callback:function(t){e.currentReview=t},expression:"currentReview"}}):e._e(),e._v(" "),r("ul",{staticClass:"reviews"},[r("li",{staticClass:"reviews__item"},[r("square-btn",{attrs:{type:"square",title:"Добавить<br>отзыв",disabled:e.editReviewIsShown},on:{click:function(t){e.editReviewIsShown=!0}}})],1),e._v(" "),e._l(e.reviews,(function(t){return r("li",{key:t.id,staticClass:"reviews__item"},[r("card-review",{attrs:{review:t},on:{remove:e.removeReview,edit:e.editReview}})],1)}))],2)],1)])};i._withStripped=!0;var n=r(0),a=r.n(n),o=r(1),s=r.n(o),c=r(24),v=r.n(c),u=r(131),w=r(78),l=r(61),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-review"},[r("div",{staticClass:"edit-review__container"},[e._m(0),e._v(" "),r("form",{staticClass:"edit-review__form",on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("div",{staticClass:"edit-review__form-wrap"},[r("div",{staticClass:"edit-review__item"},[r("label",{class:["uploader",{active:e.newReview.preview},{"uploader--hovered":e.hovered}],on:{dragover:e.handleDragOver,drop:e.handleChange,dragleave:function(t){e.hovered=!1}}},[r("div",{class:["uploader__preview",{"uploader__preview--fill":e.newReview.preview}],style:{backgroundImage:"url("+e.newReview.preview+")"}}),e._v(" "),r("div",{staticClass:"uploader__btn"},[r("app-button",{attrs:{title:"Добавить фото",typeAttr:"photo"},on:{change:e.handleChange}})],1)])]),e._v(" "),r("div",{staticClass:"edit-review__item"},[r("div",{staticClass:"edit-review__form-row"},[r("div",{staticClass:"edit-review__form-group"},[r("app-input",{attrs:{title:"Имя автора",errorMessage:e.validation.firstError("newReview.author")},model:{value:e.newReview.author,callback:function(t){e.$set(e.newReview,"author",t)},expression:"newReview.author"}})],1),e._v(" "),r("div",{staticClass:"edit-review__form-group"},[r("app-input",{attrs:{title:"Титул автора",errorMessage:e.validation.firstError("newReview.occ")},model:{value:e.newReview.occ,callback:function(t){e.$set(e.newReview,"occ",t)},expression:"newReview.occ"}})],1)]),e._v(" "),r("div",{staticClass:"edit-review__form-group"},[r("app-input",{attrs:{errorMessage:e.validation.firstError("newReview.text"),fieldType:"textarea",title:"Отзыв"},model:{value:e.newReview.text,callback:function(t){e.$set(e.newReview,"text",t)},expression:"newReview.text"}})],1),e._v(" "),r("div",{staticClass:"edit-review__btns"},[r("button",{staticClass:"edit-review__cancel-btn",on:{click:function(t){return e.$emit("cancel")}}},[e._v("Отмена")]),e._v(" "),r("appButton",{attrs:{title:"Сохранить"}})],1)])])])])])};p._withStripped=!0;var d=r(25),f=r(8),h=r.n(f),_=r(11);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=h.a.Validator,O={mixins:[h.a.mixin],validators:{"newReview.author":function(e){return R.value(e).required("Укажите автора")},"newReview.occ":function(e){return R.value(e).required("Укажите должность")},"newReview.text":function(e){return R.value(e).required("Необходимо заполнить описание")}},components:{appInput:d.default,appButton:l.a},data:function(){return{hovered:!1,newReview:{author:"",occ:"",text:"",photo:{},preview:""}}},methods:m(m({},Object(_.b)({addNewReview:"reviews/add",showTooltip:"tooltips/show"})),{},{handleSubmit:function(){var e=this;return s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,t.next=8,e.addNewReview(e.newReview);case 8:e.$emit("cancel"),e.showTooltip({text:"Данные успешно добавлены",type:"success"}),t.next=15;break;case 12:t.prev=12,t.t1=t.catch(5),e.showTooltip({text:"Произошла ошибка",type:"error"});case 15:case"end":return t.stop()}}),t,null,[[5,12]])})))()},handleChange:function(e){e.preventDefault(),console.log(e);var t=e.dataTransfer?e.dataTransfer.files[0]:e.target.files[0];this.newReview.photo=t,this.renderPhoto(t),this.hovered=!1},renderPhoto:function(e){var t=this,r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t.newReview.preview=r.result},r.onerror=function(){t.showTooltip({text:"Произошла ошибка",type:"error"})},r.onabort=function(){t.showTooltip({text:"Произошла ошибка",type:"error"})}},handleDragOver:function(e){e.preventDefault(),this.hovered=!0}})},g=(r(139),r(2)),y=Object(g.a)(O,p,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit-review__caption"},[t("h2",{staticClass:"edit-review__title"},[this._v("Редактирование/добавление отзыва")])])}],!1,null,"610f34f2",null);y.options.__file="src/admin/components/edit-review/edit-review.vue";var x=y.exports;function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k={components:{baseTemplate:u.a,cardReview:w.a,squareBtn:l.a,editReview:x},data:function(){return{editReviewIsShown:!1,currentReview:{}}},computed:C({},Object(_.c)("reviews",{reviews:function(e){return e.data}})),methods:C(C({},Object(_.b)({fetchreviews:"reviews/fetch",removeReviewAction:"reviews/remove",showTooltip:"tooltips/show"})),{},{removeReview:function(e){var t=this;return s()(a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.removeReviewAction(e);case 3:t.showTooltip({text:"Данные успешно удалены",type:"success"}),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),t.showTooltip({text:"Произошла ошибка",type:"error"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},editReview:function(e){var t=this;return s()(a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.editReviewIsShown=!0,t.currentReview=e;case 2:case"end":return r.stop()}}),r)})))()}}),mounted:function(){this.fetchreviews()}},P=Object(g.a)(k,i,[],!1,null,null,null);P.options.__file="src/admin/pages/reviews/reviews.vue";t.default=P.exports}}]);